<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>Searcher搜索引擎 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Search1. 搜索引擎1.1  什么是搜索引擎​    搜索引擎是指根据一定的策略、运用特定的计算机程序从互联网上搜集信息，在对信息进行组织和处理后，为用户提供检索服务，将用户检索相关的信息展示给用户的系统。例如: 百度 谷歌 1.2  搜索引擎基本的运行原理 1.3 原始数据库查询的缺陷 1)  慢, 当数据库中的数据量很庞大的时候, 整个的查询效率非常低, 无法及时返回内容 2) 搜索效果">
<meta property="og:type" content="article">
<meta property="og:title" content="Searcher搜索引擎">
<meta property="og:url" content="http://cyannote.github.io.git/Search/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Search1. 搜索引擎1.1  什么是搜索引擎​    搜索引擎是指根据一定的策略、运用特定的计算机程序从互联网上搜集信息，在对信息进行组织和处理后，为用户提供检索服务，将用户检索相关的信息展示给用户的系统。例如: 百度 谷歌 1.2  搜索引擎基本的运行原理 1.3 原始数据库查询的缺陷 1)  慢, 当数据库中的数据量很庞大的时候, 整个的查询效率非常低, 无法及时返回内容 2) 搜索效果">
<meta property="og:locale" content="zh-cn">
<meta property="og:image" content="d:%5Ctypora%E7%AC%94%E8%AE%B0%5CTypora%E5%9B%BE%E7%89%87%5C1563674656348.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day06_search_lucene/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day06_search_lucene/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/1532265270996.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day06_search_lucene/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E5%86%99%E5%85%A5%E7%B4%A2%E5%BC%95.jpg">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/assets/1557968128127.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E7%9A%84%E7%9B%AE%E5%BD%95%E4%BB%8B%E7%BB%8D.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E7%9A%84example%E7%9B%AE%E5%BD%95.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E7%9A%84%E5%90%AF%E5%8A%A8%E6%96%B9%E5%BC%8F1.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E7%9A%84%E6%96%B9%E5%BC%8F%E4%B8%80%E5%90%AF%E5%8A%A8%E5%90%8E%E7%9A%84%E7%95%8C%E9%9D%A2.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E5%90%AF%E5%8A%A82--1.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E5%90%AF%E5%8A%A82--2.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E5%90%AF%E5%8A%A82--3.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E5%90%AF%E5%8A%A82--4.png">
<meta property="og:image" content="d:%5Ctypora%E7%AC%94%E8%AE%B0%5CTypora%E5%9B%BE%E7%89%87%5Csolr%E5%90%AF%E5%8A%A82--5.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E5%90%AF%E5%8A%A82--7.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E5%90%AF%E5%8A%A82--8.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/assets/1557970335432.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E4%BB%AA%E8%A1%A8%E7%9B%98.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E6%97%A5%E5%BF%97%E7%AA%97%E5%8F%A3.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E8%AD%A6%E5%91%8A%E5%8E%BB%E6%8E%89%E7%AC%AC%E4%B8%80%E6%AD%A5.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E8%AD%A6%E5%91%8A%E5%8E%BB%E6%8E%89%E7%AC%AC%E4%BA%8C%E6%AD%A5.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/core%E7%9A%84%E5%9B%BE%E8%A7%A3.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AAcore%E7%AC%AC%E4%B8%80%E6%AD%A5.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AAcore%E7%AC%AC%E4%BA%8C%E6%AD%A5.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/core_selector.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/core_selector%E7%9A%84%E8%AF%A6%E8%A7%A3.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E5%86%99%E5%85%A5%E7%B4%A2%E5%BC%95.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E6%9F%A5%E8%AF%A2%E7%AA%97%E5%8F%A3%E8%AF%A6%E8%A7%A3.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E5%BC%95%E5%85%A5ik%E5%88%86%E8%AF%8D%E5%99%A8%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AD%A5.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E5%BC%95%E5%85%A5ik%E5%88%86%E8%AF%8D%E5%99%A8%E7%9A%84%E7%AC%AC%E4%BA%8C%E6%AD%A5.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E5%BC%95%E5%85%A5ik%E5%88%86%E8%AF%8D%E5%99%A8%E7%9A%84%E7%AC%AC%E4%B8%89%E6%AD%A5.png">
<meta property="og:image" content="d:%5Ctypora%E7%AC%94%E8%AE%B0%5CTypora%E5%9B%BE%E7%89%87%5C%E5%BC%95%E5%85%A5ik%E5%88%86%E8%AF%8D%E5%99%A8%E7%9A%84%E7%AC%AC%E5%9B%9B%E6%AD%A5.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/assets/1557980015574.png">
<meta property="og:image" content="d:%5Ctypora%E7%AC%94%E8%AE%B0%5CTypora%E5%9B%BE%E7%89%87%5C1557980446558.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/assets/1557990116016.png">
<meta property="og:image" content="d:%5Ctypora%E7%AC%94%E8%AE%B0%5CTypora%E5%9B%BE%E7%89%87%5C1563685934033.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1533630926299.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1533649208319.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1558141754746.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1558142487391.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1558144177890.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1533636808020.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1541863320833.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1541863595545.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1546412674865.png">
<meta property="og:image" content="f:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1558167764563.png">
<meta property="og:updated_time" content="2019-07-21T07:48:35.785Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Searcher搜索引擎">
<meta name="twitter:description" content="Search1. 搜索引擎1.1  什么是搜索引擎​    搜索引擎是指根据一定的策略、运用特定的计算机程序从互联网上搜集信息，在对信息进行组织和处理后，为用户提供检索服务，将用户检索相关的信息展示给用户的系统。例如: 百度 谷歌 1.2  搜索引擎基本的运行原理 1.3 原始数据库查询的缺陷 1)  慢, 当数据库中的数据量很庞大的时候, 整个的查询效率非常低, 无法及时返回内容 2) 搜索效果">
<meta name="twitter:image" content="d:%5Ctypora%E7%AC%94%E8%AE%B0%5CTypora%E5%9B%BE%E7%89%87%5C1563674656348.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/plugin/bganimation/bg.css">
  

</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <div class="outer">
        <div class="widget-wrap mobile-header">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="/source/plugin/img/avatar.jpg">
    <h2 class="author">inverse</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>17</strong><br>文章</div></a>
      <a href="/categories"><div><strong>0</strong><br>分类</div></a>
      <a href="/tags"><div><strong>0</strong><br>标签</div></a>
    </div>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>标签</li>
          </a>
        
    </ul>
  </div>
</div>

        <section id="main"><article id="post-Search" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/Search/" class="article-date">
  <time class="post-time" datetime="2019-07-21T08:05:08.925Z" itemprop="datePublished">
    <span class="post-month">7月</span><br>
    <span class="post-day">21</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Searcher搜索引擎
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Search"><a href="#Search" class="headerlink" title="Search"></a>Search</h1><h2 id="1-搜索引擎"><a href="#1-搜索引擎" class="headerlink" title="1. 搜索引擎"></a>1. 搜索引擎</h2><h3 id="1-1-什么是搜索引擎"><a href="#1-1-什么是搜索引擎" class="headerlink" title="1.1  什么是搜索引擎"></a>1.1  什么是搜索引擎</h3><p>​    搜索引擎是指根据一定的策略、运用特定的计算机程序从互联网上搜集信息，在对信息进行组织和处理后，为用户提供检索服务，将用户检索相关的信息展示给用户的系统。例如: 百度 谷歌</p>
<h4 id="1-2-搜索引擎基本的运行原理"><a href="#1-2-搜索引擎基本的运行原理" class="headerlink" title="1.2  搜索引擎基本的运行原理"></a>1.2  搜索引擎基本的运行原理</h4><p><img src="D:%5Ctypora%E7%AC%94%E8%AE%B0%5CTypora%E5%9B%BE%E7%89%87%5C1563674656348.png" alt="1563674656348"></p>
<h4 id="1-3-原始数据库查询的缺陷"><a href="#1-3-原始数据库查询的缺陷" class="headerlink" title="1.3 原始数据库查询的缺陷"></a>1.3 原始数据库查询的缺陷</h4><ul>
<li>1)  慢, 当数据库中的数据量很庞大的时候, 整个的查询效率非常低, 无法及时返回内容</li>
<li>2) 搜索效果比较差, 只能根据用户输入的完整关键字的进行首尾的模糊匹配</li>
<li>3)  如果用户输入的关键字出现错别字, 或者多输入了内容, 可能就导致结果远离用户期望的内容</li>
</ul>
<h4 id="1-4-倒排索引技术-理解"><a href="#1-4-倒排索引技术-理解" class="headerlink" title="1.4 倒排索引技术  (理解)"></a>1.4 倒排索引技术  (理解)</h4><p>​    倒排索引, 又称为反向索引: 以字或者词,甚至是一句话一段话作为一个关键字进行索引, 每一个关键字都会对应着一个记录项, 记录项中记录了这个关键字出现在那些文档中, 已经在此文档的什么位置上                        </p>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day06_search_lucene/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95.png" alt></p>
<p>为什么说倒排索引可以提升查询的效率和精准度呢?</p>
<p>​    倒排索引, 是将数据提前按照格式分词放好,建立索引, 当用户进行搜索, 将用户的关键字进行分词, 然后根据分词后的单词到索引库中寻找对应词条,根据词条, 查到对应所在的文档位置, 将其文档内容直接获取即可</p>
<p>整个查询过程 <strong>基于索引</strong>查询</p>
<h2 id="2-Lucene"><a href="#2-Lucene" class="headerlink" title="2. Lucene"></a>2. Lucene</h2><p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day06_search_lucene/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/1532265270996.png" alt></p>
<p>​    Lucene是Apache提供的一个开源的全文检索引擎工具包, 其本质就是一堆jar包而已, 而非一个完整的搜索引擎, 但是我们可以通过Lucene来构建一个搜索引擎</p>
<p>官方网址:  <a href="http://lucene.apache.org/" target="_blank" rel="noopener">http://lucene.apache.org/</a></p>
<h3 id="2-1-使用Lucene如何构建索引"><a href="#2-1-使用Lucene如何构建索引" class="headerlink" title="2.1 使用Lucene如何构建索引"></a>2.1 使用Lucene如何构建索引</h3><h4 id="2-1-1-第一步-导入相关的jar包-pom依赖"><a href="#2-1-1-第一步-导入相关的jar包-pom依赖" class="headerlink" title="2.1.1 第一步: 导入相关的jar包(pom依赖)"></a>2.1.1 第一步: 导入相关的jar包(pom依赖)</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.lucene<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lucene-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.lucene<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lucene-queries<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.lucene<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lucene-test-framework<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.lucene<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lucene-analyzers-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.lucene<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lucene-queryparser<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.lucene<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lucene-highlighter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-第二步-书写写入索引的代码"><a href="#2-1-2-第二步-书写写入索引的代码" class="headerlink" title="2.1.2 第二步: 书写写入索引的代码"></a>2.1.2 第二步: 书写写入索引的代码</h4><p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day06_search_lucene/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E5%86%99%E5%85%A5%E7%B4%A2%E5%BC%95.jpg" alt="img"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 索引写入相关的内容</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexWriterTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line">        <span class="comment">//1. 创建 lucene用于写入索引的核心类: IndexWriter</span></span><br><span class="line">        Directory d = FSDirectory.open(<span class="keyword">new</span> File(<span class="string">"F:\\index"</span>));</span><br><span class="line">        Analyzer analyzer = <span class="keyword">new</span> StandardAnalyzer();</span><br><span class="line">        IndexWriterConfig conf = <span class="keyword">new</span> IndexWriterConfig(Version.LATEST,analyzer);</span><br><span class="line"></span><br><span class="line">        IndexWriter indexWriter = <span class="keyword">new</span> IndexWriter(d,conf);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 添加原始文档数据</span></span><br><span class="line">        Document doc = <span class="keyword">new</span> Document();</span><br><span class="line">        doc.add(<span class="keyword">new</span> LongField(<span class="string">"id"</span>,<span class="number">1</span>, Field.Store.YES));</span><br><span class="line">        doc.add(<span class="keyword">new</span> StringField(<span class="string">"title"</span>,<span class="string">"母爱满满！哈里王子梅根王妃母亲节晒宝宝脚丫"</span>, Field.Store.YES));</span><br><span class="line">        doc.add(<span class="keyword">new</span> TextField(<span class="string">"content"</span>,<span class="string">"哈里王子梅根王妃在社交媒体上发图文"</span>, Field.Store.YES));</span><br><span class="line"></span><br><span class="line">        indexWriter.addDocument(doc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. 提交文档数据</span></span><br><span class="line">        indexWriter.commit();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. 释放资源</span></span><br><span class="line">        indexWriter.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-3-Lucene的索引修改"><a href="#2-1-3-Lucene的索引修改" class="headerlink" title="2.1.3  Lucene的索引修改"></a>2.1.3  Lucene的索引修改</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 索引的修改</span></span><br><span class="line">   <span class="comment">//  修改后的数据都在文档的最后面,   先删除, 后添加</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateIndexTest</span><span class="params">()</span> <span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line">       <span class="comment">//1. 创建indexWriter对象</span></span><br><span class="line">       Directory d = FSDirectory.open(<span class="keyword">new</span> File(<span class="string">"F:\\index"</span>));</span><br><span class="line">       IndexWriterConfig conf = <span class="keyword">new</span> IndexWriterConfig(Version.LATEST,<span class="keyword">new</span> IKAnalyzer());</span><br><span class="line">       IndexWriter indexWriter = <span class="keyword">new</span> IndexWriter(d,conf);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//2. 创建一个修改后文档对象</span></span><br><span class="line"></span><br><span class="line">       Document doc = <span class="keyword">new</span> Document();</span><br><span class="line">       doc.add(<span class="keyword">new</span> StringField(<span class="string">"id"</span>,<span class="string">"6"</span>, Field.Store.YES));</span><br><span class="line">       doc.add(<span class="keyword">new</span> TextField(<span class="string">"title"</span>,<span class="string">"这是修改后的数据"</span>, Field.Store.YES));</span><br><span class="line"></span><br><span class="line">       <span class="comment">//3. 执行修改 : 在执行修改的时候, 不要使用id字段, 因为id字段在书写的时候使用的Long类型, long类型是要分词的</span></span><br><span class="line">       <span class="comment">//  如果想根据id来修改数据, 需要将id的类型更改为StringField(不分词)</span></span><br><span class="line">       indexWriter.updateDocument(<span class="keyword">new</span> Term(<span class="string">"title"</span>,<span class="string">"杭州"</span>),doc);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//4. 提交修改</span></span><br><span class="line">       indexWriter.commit();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//5. 释放资源</span></span><br><span class="line">       indexWriter.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-4-Lucene-的索引删除"><a href="#2-1-4-Lucene-的索引删除" class="headerlink" title="2.1.4  Lucene 的索引删除"></a>2.1.4  Lucene 的索引删除</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 索引的删除</span></span><br><span class="line"></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteIndexTest</span><span class="params">()</span> <span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line">       <span class="comment">//1. 创建indexWriter对象 :  增删改</span></span><br><span class="line">       Directory d = FSDirectory.open(<span class="keyword">new</span> File(<span class="string">"F:\\index"</span>));</span><br><span class="line">       IndexWriterConfig conf = <span class="keyword">new</span> IndexWriterConfig(Version.LATEST,<span class="keyword">new</span> IKAnalyzer());</span><br><span class="line">       IndexWriter indexWriter = <span class="keyword">new</span> IndexWriter(d,conf);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//2. 执行删除索引操作</span></span><br><span class="line">       <span class="comment">//indexWriter.deleteAll(); //删除所有</span></span><br><span class="line">       indexWriter.deleteDocuments(<span class="keyword">new</span> Term(<span class="string">"title"</span>,<span class="string">"修改"</span>));  <span class="comment">// 根据词条删除</span></span><br><span class="line">       <span class="comment">//indexWriter.deleteDocuments(query);  根据条件删除</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">//3. 提交</span></span><br><span class="line">       indexWriter.commit();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//4. 释放资源</span></span><br><span class="line">       indexWriter.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-5-查询索引"><a href="#2-1-5-查询索引" class="headerlink" title="2.1.5 查询索引"></a>2.1.5 查询索引</h4><p><strong>查询解析器查询</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//索引查询的入门代码</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexSearcherTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span>  Exception </span>&#123;</span><br><span class="line">        <span class="comment">//1. 创建lucene用于查询索引核心对象</span></span><br><span class="line">        IndexReader r  = DirectoryReader.open(FSDirectory.open(<span class="keyword">new</span> File(<span class="string">"F:\\index"</span>)));</span><br><span class="line">        IndexSearcher indexSearcher = <span class="keyword">new</span> IndexSearcher(r);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 添加查询的条件</span></span><br><span class="line">        <span class="comment">//2.1 通过查询解析器的方式来获取query对象</span></span><br><span class="line">        QueryParser queryParser = <span class="keyword">new</span> QueryParser(<span class="string">"content"</span>,<span class="keyword">new</span> IKAnalyzer());</span><br><span class="line">        <span class="comment">// 参数: 表示的是用户输入的内容</span></span><br><span class="line">        Query query = queryParser.parse(<span class="string">"蓝瘦香菇吊炸天"</span>);</span><br><span class="line">        <span class="comment">//3. 执行查询</span></span><br><span class="line">        <span class="comment">// 参数1: 查询的条件</span></span><br><span class="line">        <span class="comment">//参数2:  查询前几个</span></span><br><span class="line">        <span class="comment">// 返回值: 结果集</span></span><br><span class="line">        <span class="comment">//      主要包含二部分的内容:  1)  查询的结果集的得分数组   2) 查询的总条数</span></span><br><span class="line">        TopDocs topDocs = indexSearcher.search(query, Integer.MAX_VALUE);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. 获取数据</span></span><br><span class="line">        ScoreDoc[] scoreDocs = topDocs.scoreDocs; <span class="comment">// 得分文档的数组</span></span><br><span class="line">        <span class="keyword">int</span> totalHits = topDocs.totalHits; <span class="comment">//查询的总条数</span></span><br><span class="line">        <span class="comment">// ScoreDoc :得分文档对象, 包含二部分内容:  1)  文档的id  2) 文档的得分</span></span><br><span class="line">        <span class="keyword">for</span> (ScoreDoc scoreDoc : scoreDocs) &#123;</span><br><span class="line">            <span class="keyword">float</span> score = scoreDoc.score; <span class="comment">//得分</span></span><br><span class="line">            <span class="keyword">int</span> docId = scoreDoc.doc; <span class="comment">//文档的id</span></span><br><span class="line"></span><br><span class="line">            Document document = indexSearcher.doc(docId);</span><br><span class="line">            String id = document.get(<span class="string">"id"</span>);</span><br><span class="line">            String title = document.get(<span class="string">"title"</span>);</span><br><span class="line">            String content = document.get(<span class="string">"content"</span>);</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">"文档的得分为:"</span> + score +<span class="string">" 文档的id:"</span>+id+<span class="string">" 文档的标题:"</span>+title+<span class="string">" 文档的内容:"</span>+ content);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>组合查询</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 多样化查询:  BooleanQuery  组合查询</span></span><br><span class="line">    <span class="comment">//   组合查询本身自己是没有任何的条件的, 将其他的条件组合在一块, 共同作用于着整个的查询</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *   MUST : 必须,    表示查询出来的结果必须是这个条件中的数据</span></span><br><span class="line"><span class="comment">     *   MUST_NOT:  不必须 , 表示查询出来的结果必须不能包含这个条件中的数据</span></span><br><span class="line"><span class="comment">     *   SHOULD:   应该 ,   表示查询出来的结果, 如果有这个条件中数据就显示, 没有就不显示, 对整个结果没有太大影响</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">booleanQueryTest</span><span class="params">()</span><span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line">        BooleanQuery query = <span class="keyword">new</span> BooleanQuery();</span><br><span class="line"></span><br><span class="line">        NumericRangeQuery numericRangeQuery = NumericRangeQuery.newLongRange(<span class="string">"id"</span>,<span class="number">2L</span>,<span class="number">3L</span>,<span class="keyword">true</span>,<span class="keyword">true</span>);</span><br><span class="line">        query.add(numericRangeQuery, BooleanClause.Occur.MUST);</span><br><span class="line"></span><br><span class="line">        TermQuery termQuery = <span class="keyword">new</span> TermQuery(<span class="keyword">new</span> Term(<span class="string">"title"</span>,<span class="string">"lucene"</span>));</span><br><span class="line">        query.add(termQuery, BooleanClause.Occur.MUST);</span><br><span class="line"></span><br><span class="line">        publicQuery(query);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="3-Solr"><a href="#3-Solr" class="headerlink" title="3. Solr"></a>3. Solr</h2><p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/assets/1557968128127.png" alt="1557968128127"></p>
<p>​    solr是一个企业级的搜索应用服务器, 如果想要连接solr需要通过发送http请求方法 , solr是基于lucene来来实现的.</p>
<h3 id="3-1-solr的目录介绍"><a href="#3-1-solr的目录介绍" class="headerlink" title="3.1 solr的目录介绍"></a>3.1 solr的目录介绍</h3><ul>
<li>solr的根目录</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E7%9A%84%E7%9B%AE%E5%BD%95%E4%BB%8B%E7%BB%8D.png" alt></p>
<ul>
<li>example的目录</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E7%9A%84example%E7%9B%AE%E5%BD%95.png" alt></p>
<h3 id="3-2-solr服务的启动"><a href="#3-2-solr服务的启动" class="headerlink" title="3.2  solr服务的启动"></a>3.2  solr服务的启动</h3><h4 id="3-2-1-solr的启动一-start-jar（了解）"><a href="#3-2-1-solr的启动一-start-jar（了解）" class="headerlink" title="3.2.1 solr的启动一: start.jar（了解）"></a>3.2.1 solr的启动一: start.jar（了解）</h4><p>启动步骤:</p>
<ul>
<li>1) 打开cmd窗口</li>
<li>2) 切换目录到solr的example的目录下</li>
<li>3) 执行 java -jar start.jar</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E7%9A%84%E5%90%AF%E5%8A%A8%E6%96%B9%E5%BC%8F1.png" alt></p>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E7%9A%84%E6%96%B9%E5%BC%8F%E4%B8%80%E5%90%AF%E5%8A%A8%E5%90%8E%E7%9A%84%E7%95%8C%E9%9D%A2.png" alt></p>
<p>注意:  由于jar包已经内置了一个web服务器(jetty) , 其默认的访问的为8983</p>
<h4 id="3-2-2-solr的启动二-solr-war"><a href="#3-2-2-solr的启动二-solr-war" class="headerlink" title="3.2.2 solr的启动二:  solr.war"></a>3.2.2 solr的启动二:  solr.war</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如果想要部署solr.war, 需要先准备一个tomcat, 建议准备一个全新的tomcat, 不要使用原来已经添加其他项目的tomcat, 将这个全新的tomcat放置在一个没有中文和空格的目录下, 建议放置在solr的目录下</span><br></pre></td></tr></table></figure>

<p>需要保证: tomcat是可以正常启动的, 否则不要往下执行, 先解决tomcat的问题. </p>
<p>​    一般出现的问题闪退的原因:  JAVA_HOME配置有问题  </p>
<p>启动步骤:</p>
<ul>
<li>1) 首先打开example目录下的webapps目录下</li>
<li>2) 拷贝此目录下的solr.war , 将其复制到tomcat的webapps目录下</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E5%90%AF%E5%8A%A82--1.png" alt></p>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E5%90%AF%E5%8A%A82--2.png" alt></p>
<ul>
<li>3) 启动tomcat, 将war包进行解压, 然后关闭tomcat并将war包删除或者更改后缀名即可<ul>
<li>将其原有war包更改的主要目的是防止再次解压, 导致原有的设置失效</li>
</ul>
</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E5%90%AF%E5%8A%A82--3.png" alt></p>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E5%90%AF%E5%8A%A82--4.png" alt></p>
<ul>
<li>4) 将资料中&lt;&lt;tomcat运行solr所需要的jar包&gt;&gt;复制到tomcat中solr的web-inf下的lib目录中 ,classes目录复制到web-inf下</li>
</ul>
<p><img src="D:%5Ctypora%E7%AC%94%E8%AE%B0%5CTypora%E5%9B%BE%E7%89%87%5Csolr%E5%90%AF%E5%8A%A82--5.png" alt></p>
<ul>
<li>5)将example中solr的目录建议复制到和tomcat同级的目录下(方便管理)<ul>
<li>复制后, 建议将这个索引库目录名称更改为solr-home</li>
</ul>
</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E5%90%AF%E5%8A%A82--7.png" alt></p>
<ul>
<li>6) 打开tomcat的bin目录找到Catalina.bat文件, 将其右键打开</li>
<li>7) 将下列参数设置到此文件中即可<ul>
<li>参数 :   set “JAVA_OPTS=-Dsolr.solr.home=目录位置”  </li>
<li>注意: 目录位置就是刚刚复制过来的solr的目录</li>
</ul>
</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/solr%E5%90%AF%E5%8A%A82--8.png" alt></p>
<ul>
<li>8) 启动tomcat,访问localhost:8080/solr即可</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/assets/1557970335432.png" alt="1557970335432"></p>
<h3 id="3-3-solr的管理界面"><a href="#3-3-solr的管理界面" class="headerlink" title="3.3  solr的管理界面"></a>3.3  solr的管理界面</h3><ul>
<li>仪表盘</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E4%BB%AA%E8%A1%A8%E7%9B%98.png" alt></p>
<ul>
<li>日志窗口:  记录solr在启动过程中和启动后执行过程中的执行信息</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E6%97%A5%E5%BF%97%E7%AA%97%E5%8F%A3.png" alt></p>
<p>解决警告信息:</p>
<p>​    第一步: 将solr的安装包中依赖包的两个目录, 复制到solr的索引库中</p>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E8%AD%A6%E5%91%8A%E5%8E%BB%E6%8E%89%E7%AC%AC%E4%B8%80%E6%AD%A5.png" alt></p>
<p>​    第二步: 打开索引库中的collection1中conf目录, 将solrconfig.xml右键打开, 去掉两个../即可</p>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E8%AD%A6%E5%91%8A%E5%8E%BB%E6%8E%89%E7%AC%AC%E4%BA%8C%E6%AD%A5.png" alt></p>
<ul>
<li>core 窗口: 用于配置solr的索引库<ul>
<li>solr中支持配置和管理多个索引库, 就像数据库中有多个database是一样的</li>
</ul>
</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/core%E7%9A%84%E5%9B%BE%E8%A7%A3.png" alt></p>
<p>如何配置多个索引库呢?</p>
<p>​    简单方案:  将collection1复制一个,然后删除其data文件夹并修改core.properties配置文件即可</p>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AAcore%E7%AC%AC%E4%B8%80%E6%AD%A5.png" alt></p>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AAcore%E7%AC%AC%E4%BA%8C%E6%AD%A5.png" alt></p>
<ul>
<li>core selector: core的选择器, 用来针对不同core进行操作的</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/core_selector.png" alt></p>
<p>针对core selector的详细讲解:</p>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/core_selector%E7%9A%84%E8%AF%A6%E8%A7%A3.png" alt></p>
<h4 id="3-3-1-使用solr的管理界面进行添加索引"><a href="#3-3-1-使用solr的管理界面进行添加索引" class="headerlink" title="3.3.1 使用solr的管理界面进行添加索引"></a>3.3.1 使用solr的管理界面进行添加索引</h4><p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E5%86%99%E5%85%A5%E7%B4%A2%E5%BC%95.png" alt></p>
<h4 id="3-3-2-使用solr的管理界面进行查询索引"><a href="#3-3-2-使用solr的管理界面进行查询索引" class="headerlink" title="3.3.2 使用solr的管理界面进行查询索引"></a>3.3.2 使用solr的管理界面进行查询索引</h4><p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E6%9F%A5%E8%AF%A2%E7%AA%97%E5%8F%A3%E8%AF%A6%E8%A7%A3.png" alt></p>
<blockquote>
<p>在进行查询的时候, 都是使用代码的形式进行查询索引的, 然后展示给用户的系统, 而solr提供的管理界面, 主要是为了方便程序员对solr进行管理和测试的, 比如query: 在代码中编写查询的代码后, 我们并不知道查询后可能会展示什么内容, 或者并不知道展示的内容是否正确, 使用管理界面测试一下, 看一下结果和代码的结果是否一样</p>
</blockquote>
<h3 id="3-4-solr的配置文件"><a href="#3-4-solr的配置文件" class="headerlink" title="3.4 solr的配置文件"></a>3.4 solr的配置文件</h3><p>core.properties: 设置索引库的名称</p>
<h4 id="3-4-1-solrConfig-xml-solr的核心配置文件-了解"><a href="#3-4-1-solrConfig-xml-solr的核心配置文件-了解" class="headerlink" title="3.4.1 solrConfig.xml : solr的核心配置文件(了解)"></a>3.4.1 solrConfig.xml : solr的核心配置文件(了解)</h4><p>​    solrconfig.xml 配置文件主要定义了 solr 的一些处理规则，包括索引数据的存放 位置，更新，删除，查询的一些规则配置, solr相关的优化的时候, 需要使用这个配置文件。</p>
<p>​    一般此文件不需要进行修改, 采取默认即可</p>
<h4 id="3-4-2-schema-xml-solr约束文件"><a href="#3-4-2-schema-xml-solr约束文件" class="headerlink" title="3.4.2 schema.xml: solr约束文件:"></a>3.4.2 schema.xml: solr约束文件:</h4><p>​    Solr中会提前对文档中的字段进行定义，并且在schema.xml中对这些字段的属性进行约束，例如：字段数据类型、字段是否索引、是否存储、是否分词等等</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">"example"</span> <span class="attr">version</span>=<span class="string">"1.5"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">   <span class="comment">&lt;!--  不能删除</span></span><br><span class="line"><span class="comment">   --&gt;</span> </span><br><span class="line">   <span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"_version_"</span> <span class="attr">type</span>=<span class="string">"long"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"_root_"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- 不删除</span></span><br><span class="line"><span class="comment">   --&gt;</span> </span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">		field标签:  字段标签, </span></span><br><span class="line"><span class="comment">			作用: 用来定义索引库中的字段的, 在solr中字段需要提前定义好, 而在lucene中手动定义的</span></span><br><span class="line"><span class="comment">			name :  字段的名称</span></span><br><span class="line"><span class="comment">			type :  字段的类型</span></span><br><span class="line"><span class="comment">			indexed :  是否(保存)分词</span></span><br><span class="line"><span class="comment">			stored  : 是否保存原始数据</span></span><br><span class="line"><span class="comment">			required :  是否必须存在</span></span><br><span class="line"><span class="comment">			multiValued  : 是否是多值的, 如果为true, 表示当前这个字段是一个数组</span></span><br><span class="line"><span class="comment">			</span></span><br><span class="line"><span class="comment">		id字段默认是必须存在的, 也就是说在创建document的时候, 在文档中必须要有id字段</span></span><br><span class="line"><span class="comment">			id表示的文档的唯一标识, 在solr中需要程序员自己进行维护, 在lucene中是由lucene自己维护的</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span> <span class="attr">required</span>=<span class="string">"true"</span> <span class="attr">multiValued</span>=<span class="string">"false"</span> /&gt;</span> </span><br><span class="line">        </span><br><span class="line">  </span><br><span class="line">   <span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"> </span><br><span class="line">   <span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"title"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span> <span class="attr">multiValued</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">  </span><br><span class="line">   <span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"content"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span> <span class="attr">multiValued</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"text"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"false"</span> <span class="attr">multiValued</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">   <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">		dynamicField : 动态字段(动态域)</span></span><br><span class="line"><span class="comment">			作用 :  在solr中需要提前定义一些字段的, 但是不能够保证将所有的字段都提前的定义好,动态域中将可以帮助我们动态的生成一些字段</span></span><br><span class="line"><span class="comment">			</span></span><br><span class="line"><span class="comment">			假设, 在solr启动后, 想要使用docurl的字段, 但是这个字段并没有在schema文件中定义, 如果做?</span></span><br><span class="line"><span class="comment">				1) 将solr停机, 然后更改schema的文件, 添加一个新的字段</span></span><br><span class="line"><span class="comment">					但是服务器一般启动后, 是不允许随意的停机的</span></span><br><span class="line"><span class="comment">				2) 使用动态域字段 :  docurl_i		</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dynamicField</span> <span class="attr">name</span>=<span class="string">"*_i"</span>  <span class="attr">type</span>=<span class="string">"int"</span>    <span class="attr">indexed</span>=<span class="string">"true"</span>  <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dynamicField</span> <span class="attr">name</span>=<span class="string">"*_is"</span> <span class="attr">type</span>=<span class="string">"int"</span>    <span class="attr">indexed</span>=<span class="string">"true"</span>  <span class="attr">stored</span>=<span class="string">"true"</span>  <span class="attr">multiValued</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">  </span><br><span class="line">	<span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	     uniqueKey : 表示的文档的唯一主键是那个字段 , 默认是id字段, 当然也可以进行修改</span></span><br><span class="line"><span class="comment">				设置的这个唯一的字段, 类型必须是string, 字段是必须存在的, 不能是多值</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">uniqueKey</span>&gt;</span>id<span class="tag">&lt;/<span class="name">uniqueKey</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">		copyField : 复制字段(复制域)	</span></span><br><span class="line"><span class="comment">			作用 :  主要是用于查询阶段使用的, 实现查询一个字段相当于查询多个字段</span></span><br><span class="line"><span class="comment">			source :  来源</span></span><br><span class="line"><span class="comment"> 			dest   :  目的地</span></span><br><span class="line"><span class="comment">			</span></span><br><span class="line"><span class="comment">	    以下这两个标签描述的意思:</span></span><br><span class="line"><span class="comment">			将content 和 title字段中的索引数据复制一份出来, 放置到text的字段中, 这样当查询text字段的时候, 就相当于查询title和content</span></span><br><span class="line"><span class="comment">		复制域中目的地的字段必须是一个多值的字段</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">copyField</span> <span class="attr">source</span>=<span class="string">"content"</span> <span class="attr">dest</span>=<span class="string">"text"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">copyField</span> <span class="attr">source</span>=<span class="string">"title"</span> <span class="attr">dest</span>=<span class="string">"text"</span>/&gt;</span></span><br><span class="line">  </span><br><span class="line">	<span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">		fieldType : 字段类型, </span></span><br><span class="line"><span class="comment">			作用:  定义字段类型的</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"string"</span> <span class="attr">class</span>=<span class="string">"solr.StrField"</span> <span class="attr">sortMissingLast</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"boolean"</span> <span class="attr">class</span>=<span class="string">"solr.BoolField"</span> <span class="attr">sortMissingLast</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"int"</span> <span class="attr">class</span>=<span class="string">"solr.TrieIntField"</span> <span class="attr">precisionStep</span>=<span class="string">"0"</span> <span class="attr">positionIncrementGap</span>=<span class="string">"0"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"float"</span> <span class="attr">class</span>=<span class="string">"solr.TrieFloatField"</span> <span class="attr">precisionStep</span>=<span class="string">"0"</span> <span class="attr">positionIncrementGap</span>=<span class="string">"0"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"long"</span> <span class="attr">class</span>=<span class="string">"solr.TrieLongField"</span> <span class="attr">precisionStep</span>=<span class="string">"0"</span> <span class="attr">positionIncrementGap</span>=<span class="string">"0"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"double"</span> <span class="attr">class</span>=<span class="string">"solr.TrieDoubleField"</span> <span class="attr">precisionStep</span>=<span class="string">"0"</span> <span class="attr">positionIncrementGap</span>=<span class="string">"0"</span>/&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"date"</span> <span class="attr">class</span>=<span class="string">"solr.TrieDateField"</span> <span class="attr">precisionStep</span>=<span class="string">"0"</span> <span class="attr">positionIncrementGap</span>=<span class="string">"0"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">schema</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>要求: 能够自己手动的添加字段即可, 能够根据需要添加一个复制域的标签</p>
<p>例如:  想要添加一个 docurl的字段, 这个字段的类型是string, 字段的需要进行分词的, 原始也需要保存, 不是一个多值的字段</p>
<p>例如: 娱乐头条中, 当查询新闻数据的时候, 一般需要根据那些字段来查询?</p>
<h4 id="3-4-3-引入ik分词器"><a href="#3-4-3-引入ik分词器" class="headerlink" title="3.4.3  引入ik分词器"></a>3.4.3  引入ik分词器</h4><ul>
<li>第一步: 导入ik相关的依赖包<ul>
<li>将三个文件放置在tomcat&gt;webapps&gt;solr&gt;WEB-INF&gt;lib下(此步骤在部署solr到tomcat中的时候, 就已经导入了)</li>
</ul>
</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E5%BC%95%E5%85%A5ik%E5%88%86%E8%AF%8D%E5%99%A8%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AD%A5.png" alt></p>
<ul>
<li>第二步: 导入ik相关的配置文件(ik配置文件, 扩展词典和停止词典)<ul>
<li>将三个文件放置在tomcat&gt;webapps&gt;solr&gt;WEB-INF&gt;classes下(此步骤, 在部署solr到tomcat中的时候, 已经导入)</li>
</ul>
</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E5%BC%95%E5%85%A5ik%E5%88%86%E8%AF%8D%E5%99%A8%E7%9A%84%E7%AC%AC%E4%BA%8C%E6%AD%A5.png" alt></p>
<ul>
<li>第三步, 在schema.xml配置文件中自定义一个字段类型, 引入ik分词器</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"text_ik"</span> <span class="attr">class</span>=<span class="string">"solr.TextField"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">analyzer</span> <span class="attr">class</span>=<span class="string">"org.wltea.analyzer.lucene.IKAnalyzer"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">fieldType</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E7%89%87/%E5%BC%95%E5%85%A5ik%E5%88%86%E8%AF%8D%E5%99%A8%E7%9A%84%E7%AC%AC%E4%B8%89%E6%AD%A5.png" alt></p>
<ul>
<li>第四步: 为对应的字段设置为text_ik类型即可</li>
</ul>
<p><img src="D:%5Ctypora%E7%AC%94%E8%AE%B0%5CTypora%E5%9B%BE%E7%89%87%5C%E5%BC%95%E5%85%A5ik%E5%88%86%E8%AF%8D%E5%99%A8%E7%9A%84%E7%AC%AC%E5%9B%9B%E6%AD%A5.png" alt></p>
<h3 id="3-5-solr的客户端操作-solrj"><a href="#3-5-solr的客户端操作-solrj" class="headerlink" title="3.5. solr的客户端操作: solrj"></a>3.5. solr的客户端操作: solrj</h3><p>​    solrj是Apache官方提供的一套java开发的, 用于操作solr服务的API, 通过这套API可以让java程序与solr服务进行交互, 让java程序可以直接操作solr服务进行增删改查</p>
<p>solrj的官网网址: <a href="https://wiki.apache.org/solr/Solrj" target="_blank" rel="noopener">https://wiki.apache.org/solr/Solrj</a></p>
<h4 id="3-5-1-solr的基本入门程序"><a href="#3-5-1-solr的基本入门程序" class="headerlink" title="3.5.1 solr的基本入门程序"></a>3.5.1 solr的基本入门程序</h4><ul>
<li>第一步: 导入相关的jar包</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.solr<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>solr-solrj<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--日志的包, solrj执行需要一个日志包--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-logging-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>编写入门程序(写入索引)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 写入索引的入门代码(原生写入)</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">indexWriterTest01</span><span class="params">()</span> <span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1. 创建solrj连接solr的远程服务对象 : #表示的页面的路径 不带#号才是访问的接口路径</span></span><br><span class="line">        SolrServer solrServer = <span class="keyword">new</span> HttpSolrServer(<span class="string">"http://localhost:8080/solr/collection1"</span>);</span><br><span class="line">        <span class="comment">//2. 添加文档数据</span></span><br><span class="line">        SolrInputDocument doc = <span class="keyword">new</span> SolrInputDocument();</span><br><span class="line">        doc.addField(<span class="string">"id"</span>,<span class="number">1</span>);</span><br><span class="line">        doc.addField(<span class="string">"title"</span>,<span class="string">"连休三天！端午节放假通知来了"</span>);</span><br><span class="line">        doc.addField(<span class="string">"content"</span>,<span class="string">"请广大市民提前安排好工作生活，节日期间注意安全，度过一个平安、祥和的节日假期。"</span>);</span><br><span class="line"></span><br><span class="line">        solrServer.add(doc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. 提交数据</span></span><br><span class="line">        solrServer.commit();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-5-2-使用solrj写入索引-使用javabean进行写入"><a href="#3-5-2-使用solrj写入索引-使用javabean进行写入" class="headerlink" title="3.5.2 使用solrj写入索引(使用javabean进行写入)"></a>3.5.2 使用solrj写入索引(使用javabean进行写入)</h4><p>一个标准的javaBean都具备什么条件?</p>
<ul>
<li>1) 成员属性必须私有化</li>
<li>2) 必须为成员属性提供get 和 set方法</li>
<li>3) 必须提供无参的构造方法</li>
<li>4)  必须要实现序列化接口: 只要实现可这个接口, 那么这个对象支持网络io操作及持久化到磁盘的操作</li>
</ul>
<p>pojo类:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class News implements Serializable &#123;</span><br><span class="line">    private String id;</span><br><span class="line">    private String title;</span><br><span class="line">    private String content;</span><br><span class="line">    private String docurl;</span><br><span class="line">   //  省略了 get  和  set方法  和 toString的方法</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>代码的实现</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 直接写入一个javaBean对象</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">indexWriterTest03</span><span class="params">()</span> <span class="keyword">throws</span>  Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1. 创建solrj连接solr的服务对象</span></span><br><span class="line">        SolrServer solrServer = <span class="keyword">new</span> HttpSolrServer(<span class="string">"http://localhost:8080/solr/collection1"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 添加文档数据</span></span><br><span class="line">        News news = <span class="keyword">new</span> News(<span class="string">"8"</span>,<span class="string">"国务院定了！11月底前在全国全面实施“携号转网”"</span>,<span class="string">"国务院总理李克强5月14日主持召开国务院常务会议，部署进一步推动网络提速降费，发挥扩内需稳就业惠民生多重效应"</span>,<span class="string">"http://baijiahao.baidu.com/s?id=1633615346318630206"</span>);</span><br><span class="line"></span><br><span class="line">        solrServer.addBean(news);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. 提交数据</span></span><br><span class="line">        solrServer.commit();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/assets/1557980015574.png" alt="1557980015574"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">出现错误的原因: solr并不知道在pojo中那个字段是solr的字段, 所以solr报错显示没有定义字段错误</span><br><span class="line">	解决方案: 告诉solr那个是你的字段</span><br><span class="line">		添加一个字段的注解即可 :  @Field</span><br><span class="line">如果字段的值 和 solr中字段不匹配, 可以在注解后面添加指定的字段值, 标识将pojo中属性放置到这个字段中</span><br></pre></td></tr></table></figure>

<p><img src="D:%5Ctypora%E7%AC%94%E8%AE%B0%5CTypora%E5%9B%BE%E7%89%87%5C1557980446558.png" alt="1557980446558"></p>
<h4 id="3-5-3-删除索引"><a href="#3-5-3-删除索引" class="headerlink" title="3.5.3 删除索引"></a>3.5.3 删除索引</h4><p>修改索引: 只要保证id一致, 就是修改索引的操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除索引</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delIndexTest04</span><span class="params">()</span> <span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line">        <span class="comment">//1. 创建solrj连接solr的而服务对象</span></span><br><span class="line">        SolrServer solrServer = <span class="keyword">new</span> HttpSolrServer(<span class="string">"http://localhost:8080/solr/collection1"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 添加删除的条件</span></span><br><span class="line">        <span class="comment">//solrServer.deleteById("change.me");  根据id删除</span></span><br><span class="line">        <span class="comment">//solrServer.deleteByQuery("*:*"); //删除所有</span></span><br><span class="line">        solrServer.deleteByQuery(<span class="string">"id:1"</span>); <span class="comment">//删除所有</span></span><br><span class="line">        <span class="comment">//3. 执行删除</span></span><br><span class="line"></span><br><span class="line">        solrServer.commit();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-5-4-查询操作"><a href="#3-5-4-查询操作" class="headerlink" title="3.5.4 查询操作"></a>3.5.4 查询操作</h4><h5 id="3-5-4-1-查询入门代码-原始"><a href="#3-5-4-1-查询入门代码-原始" class="headerlink" title="3.5.4.1 查询入门代码(原始)"></a>3.5.4.1 查询入门代码(原始)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1) 查询索引的入门代码(原生)</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">indexSearcherTest01</span><span class="params">()</span> <span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line">    <span class="comment">//1. 创建solrj连接solr的服务对象</span></span><br><span class="line">    SolrServer solrServer = <span class="keyword">new</span> HttpSolrServer(<span class="string">"http://localhost:8080/solr/collection1"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. 封装查询的条件</span></span><br><span class="line">    SolrQuery query = <span class="keyword">new</span> SolrQuery(<span class="string">"*:*"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3. 执行查询</span></span><br><span class="line">    QueryResponse response = solrServer.query(query);</span><br><span class="line">    <span class="comment">//4. 获取数据</span></span><br><span class="line">    SolrDocumentList documentList = response.getResults();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (SolrDocument document : documentList) &#123;</span><br><span class="line">        String id = (String) document.get(<span class="string">"id"</span>);</span><br><span class="line">        String content = (String) document.get(<span class="string">"content"</span>);</span><br><span class="line">        ArrayList&lt;String&gt; title = (ArrayList&lt;String&gt; ) document.get(<span class="string">"title"</span>);</span><br><span class="line">        String docurl_i = (String) document.get(<span class="string">"docurl_i"</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(id+<span class="string">"  "</span>+title+<span class="string">"   "</span>+content+<span class="string">"  "</span>+ docurl_i);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-5-4-2-返回javaBean"><a href="#3-5-4-2-返回javaBean" class="headerlink" title="3.5.4.2 返回javaBean"></a>3.5.4.2 返回javaBean</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2.  查询索引, 返回javaBean对象</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">indexSearcherTest02</span><span class="params">()</span> <span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line">        <span class="comment">//1. 创建solrj 连接solr的服务对象</span></span><br><span class="line">        SolrServer solrServer  =  <span class="keyword">new</span> HttpSolrServer(<span class="string">"http://localhost:8080/solr/collection1"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 封装查询条件</span></span><br><span class="line">        SolrQuery solrQuery = <span class="keyword">new</span> SolrQuery(<span class="string">"*:*"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. 执行查询</span></span><br><span class="line">        QueryResponse response = solrServer.query(solrQuery);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. 获取数据  : 采用的第三种方式来解决数据无法转换的问题</span></span><br><span class="line">        ArrayList&lt;News&gt; newsArrayList = <span class="keyword">new</span> ArrayList&lt;News&gt;();</span><br><span class="line">        SolrDocumentList documentList = response.getResults();</span><br><span class="line">        <span class="keyword">for</span> (SolrDocument document : documentList) &#123;</span><br><span class="line">            News news = <span class="keyword">new</span> News();</span><br><span class="line"></span><br><span class="line">            String id = (String) document.get(<span class="string">"id"</span>);</span><br><span class="line">            news.setId(id);</span><br><span class="line">            String content = (String) document.get(<span class="string">"content"</span>);</span><br><span class="line">            news.setContent(content);</span><br><span class="line">            ArrayList&lt;String&gt; title = (ArrayList&lt;String&gt; ) document.get(<span class="string">"title"</span>);</span><br><span class="line">            news.setTitle(title.get(<span class="number">0</span>));</span><br><span class="line">            String docurl_i = (String) document.get(<span class="string">"docurl_i"</span>);</span><br><span class="line">            news.setDocurl(docurl_i);</span><br><span class="line"></span><br><span class="line">            newsArrayList.add(news);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(newsArrayList);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day07_search_solr/%E7%AC%94%E8%AE%B0/assets/1557990116016.png" alt="1557990116016"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">原因: 不能将一个集合类型的数据转换成一个字符串</span><br><span class="line"></span><br><span class="line">解决方案:</span><br><span class="line">	1) schema.xml中配置信息: 将多值的字段更改为单值字段</span><br><span class="line">		注意: 一旦将约束文件修改了, 建议将数据全部清空, 重新添加, 所以在添加数据之前, 一定要确认配置文件是没有问题的</span><br><span class="line">	2) 将javaBean中指定的字段更改为对应的类型即可</span><br><span class="line">	3) 手动人为封装即可(推荐使用)</span><br></pre></td></tr></table></figure>

<h5 id="3-5-4-2-复杂查询"><a href="#3-5-4-2-复杂查询" class="headerlink" title="3.5.4.2 复杂查询"></a>3.5.4.2 复杂查询</h5><ul>
<li>抽取一个公共的查询的方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 抽取一个公共的查询的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">publicQuery</span><span class="params">(SolrQuery query)</span> <span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1. 创建 solrj连接solr的服务对象</span></span><br><span class="line">        SolrServer solrServer  = <span class="keyword">new</span> HttpSolrServer(<span class="string">"http://localhost:8080/solr/collection1"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 封装查询的条件</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. 执行查询</span></span><br><span class="line"></span><br><span class="line">        QueryResponse response = solrServer.query(query);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. 获取数据</span></span><br><span class="line">        List&lt;News&gt; newsList = response.getBeans(News.class);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (News news : newsList) &#123;</span><br><span class="line">            System.out.println(news);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>在创建SolrQuery时，我们填写的Query语句，可以有以下高级写法：</p>
<p>查询语句中如果有特殊字符，需要转义，可以使用：  ” ”</p>
<p>1、匹配所有文档：*:* （通配符？和 * ：“*”表示匹配任意字符；“?”表示匹配出现的位置）</p>
<p>2、布尔操作：AND、OR和NOT布尔操作（推荐使用大写，区分普通字段）</p>
<p>3、子表达式查询（子查询）：可以使用“()”构造子查询。 比如：(query1 AND query2) OR (query3 AND query4)</p>
<p>4、相似度查询：</p>
<p>（1）默认相似度查询：title:appla~，此时默认编辑距离是2</p>
<p>（2）指定编辑距离的相似度查询：对模糊查询可以设置编辑距离，可选0<del>2的整数：title:appla</del>1。</p>
<p>5、范围查询（Range Query）：solre支持对数字、日期甚至文本的范围查询，并且两端范围。结束的范围可以使用“*”通配符。</p>
<p>（1）日期范围（ISO-8601 时间GMT）：birthday:[1990-01-01T00:00:00.000Z TO 1999-12-31T24:59:99.999Z]</p>
<p>（2）数字：age:[2000 TO *] </p>
<p>（3）文本：content:[a TO a]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 复杂查询:</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">complexQueryTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//1.  通配符查询 :  *   ?</span></span><br><span class="line">        <span class="comment">// SolrQuery query = new SolrQuery("content:luce*");</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 相似度查询   和 lucene的模糊查询    最大编辑次数 2次</span></span><br><span class="line">        <span class="comment">// 可以在~的后面修改最大的编辑次数范围 0~2 , 如果编写的范围不是这个范围之内的数字, 那么solr修改为默认值 2</span></span><br><span class="line">        <span class="comment">// SolrQuery query = new SolrQuery("content:lucene~");</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. 范围查询 :    对 数字, 文本, 日期进行范围查询</span></span><br><span class="line">        <span class="comment">// 格式 :  字段名称 :  [min TO MAX]</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 根据id查询, 是文本范围呢?  还是数字范围 ?     是文本范围, 因为id类似是字符串</span></span><br><span class="line">        <span class="comment">// 文本范围:  按照字典的顺序进行排列</span></span><br><span class="line">        <span class="comment">// 字典顺序 :   1 2 3 4 5 6 7 8  9 10  11 12  13   22  33  44  55</span></span><br><span class="line">        <span class="comment">//      按照字典顺序:从小到大  1 10 11 12 13  2 22  3 33 4 44  5  55  6 7 8  9</span></span><br><span class="line">        <span class="comment">//  例如: 手机通信录, 微信通信录</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 日期范围:  在solr中对于日期的格式是有明确规定的, 在solr中采用日期的格式为国际通用时间UTC(国际协调时间)格式</span></span><br><span class="line">        <span class="comment">//  UTC格式 :  yyyy-MM-dd'T'HH:mm:ss'Z'</span></span><br><span class="line">        <span class="comment">//  国际时间 和 中国时间  是有时间差 :  8个小时, 中国属于东八区  和大于国际时间八个小时</span></span><br><span class="line">        <span class="comment">// 所以当向solr中存储一个日期类型的值:  日期的时间差的问题, 建议转换成国内时间</span></span><br><span class="line">        <span class="comment">//  如果拿到的时候, 本身就是国内时间值, 采用字符串的形式写入到solr的索引库, 那么solr索引库不会将其-8小时的</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">//  SolrQuery query = new SolrQuery("id:[1 TO 5]");</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.  布尔操作  和  lucene中BooleanQuery 是类似的</span></span><br><span class="line">        <span class="comment">/**  SOLR      LUCENE</span></span><br><span class="line"><span class="comment">         *   AND       MUST</span></span><br><span class="line"><span class="comment">         *   NOT       MUST_NOT</span></span><br><span class="line"><span class="comment">         *   OR        SHOULD</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// 5 子表达式 :  布尔查询中派生出来查询的方式  id:[2 TO 5] AND (content:lucene OR title:5)</span></span><br><span class="line">        SolrQuery query = <span class="keyword">new</span> SolrQuery(<span class="string">"id:[2 TO 5] AND (content:lucene OR title:5) NOT content:3"</span>);  <span class="comment">// 5 2 3 4 7</span></span><br><span class="line"></span><br><span class="line">        publicQuery(query);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>SolrQuery :  将这个对象可以看做是整个搜索的界面对象</p>
<p>​    所以整个查询的界面中所有的参数都可以通过SolrQuery来封装查询处理</p>
<p>​    支持复杂的查询方式 </p>
</blockquote>
<h3 id="3-6-solr的高级"><a href="#3-6-solr的高级" class="headerlink" title="3.6. solr的高级"></a>3.6. solr的高级</h3><h4 id="3-6-1-solr的高亮"><a href="#3-6-1-solr的高亮" class="headerlink" title="3.6.1 solr的高亮"></a>3.6.1 solr的高亮</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// solr的高亮</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">highlighterTest01</span><span class="params">()</span> <span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line">        <span class="comment">//1. 创建solrj连接solr的服务对象</span></span><br><span class="line">        SolrServer solrServer = <span class="keyword">new</span> HttpSolrServer(<span class="string">"http://localhost:8080/solr/collection1"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 封装查询的条件 : SolrQuery</span></span><br><span class="line">        SolrQuery solrQuery = <span class="keyword">new</span> SolrQuery(<span class="string">"content:solr是apache节日期间"</span>);</span><br><span class="line">        <span class="comment">//2.1 高亮的参数</span></span><br><span class="line">        solrQuery.setHighlight(<span class="keyword">true</span>); <span class="comment">//开启高亮</span></span><br><span class="line">        solrQuery.addHighlightField(<span class="string">"title"</span>);</span><br><span class="line">        solrQuery.addHighlightField(<span class="string">"content"</span>);</span><br><span class="line">        solrQuery.setHighlightSimplePre(<span class="string">"&lt;font color='red'&gt;"</span>);</span><br><span class="line">        solrQuery.setHighlightSimplePost(<span class="string">"&lt;/font&gt;"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. 执行查询</span></span><br><span class="line">        QueryResponse response = solrServer.query(solrQuery);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. 获取数据</span></span><br><span class="line">        List&lt;News&gt; newsList = response.getBeans(News.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. 获取高亮</span></span><br><span class="line">        <span class="comment">// 最外层的MAP:  KEY  高亮的文档的id值</span></span><br><span class="line">        <span class="comment">//  内层的map : key  表示的高亮的字段</span></span><br><span class="line">        <span class="comment">//   list集合:  存储对应高亮字段的高亮的内容, 一般来说list集合中只有一个值</span></span><br><span class="line">        Map&lt;String, Map&lt;String, List&lt;String&gt;&gt;&gt; highlighting = response.getHighlighting();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (News news : newsList) &#123;</span><br><span class="line"></span><br><span class="line">            String id = news.getId();</span><br><span class="line">            Map&lt;String, List&lt;String&gt;&gt; listMap = highlighting.get(id);</span><br><span class="line">            List&lt;String&gt; list = listMap.get(<span class="string">"title"</span>);</span><br><span class="line">            <span class="keyword">if</span>(list != <span class="keyword">null</span>  &amp;&amp; list.size()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="comment">// 表示有title的高亮</span></span><br><span class="line">                news.setTitle(list.get(<span class="number">0</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            list = listMap.get(<span class="string">"content"</span>);</span><br><span class="line">            <span class="keyword">if</span>(list != <span class="keyword">null</span>  &amp;&amp; list.size()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="comment">// 表示有title的高亮</span></span><br><span class="line">                news.setContent(list.get(<span class="number">0</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.out.println(news);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-6-2-solr的排序"><a href="#3-6-2-solr的排序" class="headerlink" title="3.6.2 solr的排序"></a>3.6.2 solr的排序</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sortTest02</span><span class="params">()</span> <span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line">        <span class="comment">//1. 创建solrj连接solr的服务对象</span></span><br><span class="line">        SolrServer solrServer = <span class="keyword">new</span> HttpSolrServer(<span class="string">"http://localhost:8080/solr/collection1"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 封装查询的条件 : SolrQuery</span></span><br><span class="line">        SolrQuery solrQuery = <span class="keyword">new</span> SolrQuery(<span class="string">"content:solr是apache节日期间"</span>);</span><br><span class="line">        <span class="comment">//2.1 高亮的参数</span></span><br><span class="line">        solrQuery.setHighlight(<span class="keyword">true</span>); <span class="comment">//开启高亮</span></span><br><span class="line">        solrQuery.addHighlightField(<span class="string">"title"</span>);</span><br><span class="line">        solrQuery.addHighlightField(<span class="string">"content"</span>);</span><br><span class="line">        solrQuery.setHighlightSimplePre(<span class="string">"&lt;font color='red'&gt;"</span>);</span><br><span class="line">        solrQuery.setHighlightSimplePost(<span class="string">"&lt;/font&gt;"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.2  添加排序的条件</span></span><br><span class="line">        solrQuery.setSort(<span class="string">"id"</span>, SolrQuery.ORDER.asc);</span><br><span class="line">        <span class="comment">//3. 执行查询</span></span><br><span class="line">        QueryResponse response = solrServer.query(solrQuery);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. 获取数据</span></span><br><span class="line">        List&lt;News&gt; newsList = response.getBeans(News.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. 获取高亮</span></span><br><span class="line">        <span class="comment">// 最外层的MAP:  KEY  高亮的文档的id值</span></span><br><span class="line">        <span class="comment">//  内层的map : key  表示的高亮的字段</span></span><br><span class="line">        <span class="comment">//   list集合:  存储对应高亮字段的高亮的内容, 一般来说list集合中只有一个值</span></span><br><span class="line">        Map&lt;String, Map&lt;String, List&lt;String&gt;&gt;&gt; highlighting = response.getHighlighting();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (News news : newsList) &#123;</span><br><span class="line"></span><br><span class="line">            String id = news.getId();</span><br><span class="line">            Map&lt;String, List&lt;String&gt;&gt; listMap = highlighting.get(id);</span><br><span class="line">            List&lt;String&gt; list = listMap.get(<span class="string">"title"</span>);</span><br><span class="line">            <span class="keyword">if</span>(list != <span class="keyword">null</span>  &amp;&amp; list.size()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="comment">// 表示有title的高亮</span></span><br><span class="line">                news.setTitle(list.get(<span class="number">0</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            list = listMap.get(<span class="string">"content"</span>);</span><br><span class="line">            <span class="keyword">if</span>(list != <span class="keyword">null</span>  &amp;&amp; list.size()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="comment">// 表示有title的高亮</span></span><br><span class="line">                news.setContent(list.get(<span class="number">0</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.out.println(news);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-6-3-solr的分页"><a href="#3-6-3-solr的分页" class="headerlink" title="3.6.3 solr的分页"></a>3.6.3 solr的分页</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 分页</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pageTest03</span><span class="params">()</span> <span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> page = <span class="number">3</span>; <span class="comment">//当前页</span></span><br><span class="line">        <span class="keyword">int</span> pageSize = <span class="number">2</span>; <span class="comment">// 每页的条数</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//1. 创建solrj连接solr的服务对象</span></span><br><span class="line">        SolrServer solrServer = <span class="keyword">new</span> HttpSolrServer(<span class="string">"http://localhost:8080/solr/collection1"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 封装查询的条件 : SolrQuery</span></span><br><span class="line">        SolrQuery solrQuery = <span class="keyword">new</span> SolrQuery(<span class="string">"content:solr是apache节日期间"</span>);</span><br><span class="line">        <span class="comment">//2.1 高亮的参数</span></span><br><span class="line">        solrQuery.setHighlight(<span class="keyword">true</span>); <span class="comment">//开启高亮</span></span><br><span class="line">        solrQuery.addHighlightField(<span class="string">"title"</span>);</span><br><span class="line">        solrQuery.addHighlightField(<span class="string">"content"</span>);</span><br><span class="line">        solrQuery.setHighlightSimplePre(<span class="string">"&lt;font color='red'&gt;"</span>);</span><br><span class="line">        solrQuery.setHighlightSimplePost(<span class="string">"&lt;/font&gt;"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.2  添加排序的条件</span></span><br><span class="line">        solrQuery.setSort(<span class="string">"id"</span>, SolrQuery.ORDER.asc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.3 封装分页的条件</span></span><br><span class="line">        solrQuery.setStart( (page-<span class="number">1</span>)*pageSize );</span><br><span class="line">        solrQuery.setRows(pageSize);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. 执行查询</span></span><br><span class="line">        QueryResponse response = solrServer.query(solrQuery);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. 获取数据</span></span><br><span class="line">        List&lt;News&gt; newsList = response.getBeans(News.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. 获取高亮</span></span><br><span class="line">        <span class="comment">// 最外层的MAP:  KEY  高亮的文档的id值</span></span><br><span class="line">        <span class="comment">//  内层的map : key  表示的高亮的字段</span></span><br><span class="line">        <span class="comment">//   list集合:  存储对应高亮字段的高亮的内容, 一般来说list集合中只有一个值</span></span><br><span class="line">        Map&lt;String, Map&lt;String, List&lt;String&gt;&gt;&gt; highlighting = response.getHighlighting();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (News news : newsList) &#123;</span><br><span class="line"></span><br><span class="line">            String id = news.getId();</span><br><span class="line">            Map&lt;String, List&lt;String&gt;&gt; listMap = highlighting.get(id);</span><br><span class="line">            List&lt;String&gt; list = listMap.get(<span class="string">"title"</span>);</span><br><span class="line">            <span class="keyword">if</span>(list != <span class="keyword">null</span>  &amp;&amp; list.size()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="comment">// 表示有title的高亮</span></span><br><span class="line">                news.setTitle(list.get(<span class="number">0</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            list = listMap.get(<span class="string">"content"</span>);</span><br><span class="line">            <span class="keyword">if</span>(list != <span class="keyword">null</span>  &amp;&amp; list.size()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="comment">// 表示有title的高亮</span></span><br><span class="line">                news.setContent(list.get(<span class="number">0</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.out.println(news);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>总结: </p>
<ul>
<li>1) solr的基本概念:  solr是apache官方提供的一个企业级的全文搜索应用服务器, 连接solr服务器需要发送http请求, solr的底层是lucene</li>
<li>2) solr的部署 :<ul>
<li>2.1) solr的下载 : 1) 通过官网(只能下载最新版本) 2) 下载历史的版本 3) 使用资料提供好的</li>
<li>2.2) solr的目录的结构 : </li>
<li>2.3) solr的部署:  <ul>
<li>2.3.1)  一种采用start.jar 的方式部署(最简单的方式),内置了jetty的服务器(8983)</li>
<li>2.3.2) 采用 solr.war方式进行部署(步骤比较多), 部署在tomcat中  (需要参考文档部署成功)</li>
</ul>
</li>
</ul>
</li>
<li>3) solr的管理界面 :  会操作即可<ul>
<li>3.1) 检测某一个字段的分词效果</li>
<li>3.2) 使用管理界面能够添加索引和修改索引</li>
<li>3.3) 使用管理界面可以查询索引数据</li>
<li>3.4) 查看某一个字段在索引库中分词内容</li>
</ul>
</li>
<li>4) solr的配置文件 :<ul>
<li>4.1) core.properties:  配置索引库的名称</li>
<li>4.2) solrConfig.xml:  对solr的服务器进行相关的配置</li>
<li>4.3) <strong>schema.xml</strong> : 对solr的索引库进行相关的配置</li>
</ul>
</li>
<li>5) solr的客户端操作:solrj的操作   ——-会操作, 尽可能不用查看文档内容<ul>
<li>使用solrj完成 对solr索引库的CURD操作</li>
<li>使用solrj完成对solr高级的操作: 高亮, 排序, 分页</li>
</ul>
</li>
</ul>
<p>常见错误:</p>
<p><img src="D:%5Ctypora%E7%AC%94%E8%AE%B0%5CTypora%E5%9B%BE%E7%89%87%5C1563685934033.png" alt="1563685934033"></p>
<hr>
<h2 id="4-solrCloud"><a href="#4-solrCloud" class="headerlink" title="4.solrCloud"></a>4.solrCloud</h2><p>​    SolrCloud(solr 云)是Solr提供的分布式搜索方案，当你需要大规模，容错，分布式索引和检索能力时使用 SolrCloud。当一个系统的索引数据量少的时候是不需要使用SolrCloud，当<strong>索引量很大</strong>，<strong>搜索请求并发很高</strong>，这时需要使用SolrCloud来满足这些需求。</p>
<h3 id="1solrCloud的结构"><a href="#1solrCloud的结构" class="headerlink" title="1solrCloud的结构"></a>1solrCloud的结构</h3><p>​    SolrCloud为了降低单机的处理压力，需要由多台服务器共同来完成索引和搜索任务。实现的思路是将索引数据进行Shard（分片）拆分，每个分片由多台的服务器共同完成，当一个索引或搜索请求过来时会分别从不同的Shard的服务器中操作索引。</p>
<p>​    SolrCloud需要Solr基于Zookeeper部署，Zookeeper是一个集群管理软件，由于SolrCloud需要由多台服务器组成，由zookeeper来进行协调管理。</p>
<p>下图是一个SolrCloud应用的例子：</p>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1533630926299.png" alt="1533630926299"></p>
<ul>
<li>物理结构:<ul>
<li>指定就是三台solr服务器(直白一点就是三个部署了solr的tomcat)<ul>
<li>每个tomcat中都有两个core(索引库)</li>
</ul>
</li>
</ul>
</li>
<li>逻辑结构<ul>
<li>我们把整个集群看做了一个整体(一个大的索引库), 在这个索引库下有两个分片(也就是把索引库分成两部分), 每一个分片都有三个节点(对应就是物理结果中各个tomcat的索引库),其中一个为主节点,两个备份节点</li>
</ul>
</li>
</ul>
<p>整体部署的结构图:</p>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1533649208319.png" alt="1533649208319"></p>
<h3 id="2-solr集群中数据的读取及分裂流程"><a href="#2-solr集群中数据的读取及分裂流程" class="headerlink" title="2. solr集群中数据的读取及分裂流程"></a>2. solr集群中数据的读取及分裂流程</h3><ul>
<li>写数据的流程</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1558141754746.png" alt="1558141754746"></p>
<blockquote>
<p>写入的流程中: 写入索引的节点是每个分片的主节点</p>
<p>请问: 如果能够让分片中数据保存均衡呢? </p>
<p>​    1) 你一下我一下(轮询)</p>
<p>​    2) hash取模计算法 :  先对数据进行hash取值, 得到一个int类型的hash值, 除于当前分片的数量, 对其取余:  0~分片的数量-1 ,  得到那个结果,  将其保存在对应编号的分片中即可</p>
<p>​    随着数量量越大, 均匀分配越好</p>
</blockquote>
<ul>
<li>读数据</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1558142487391.png" alt="1558142487391"></p>
<blockquote>
<p>读数据过程, 不需要master程序参与的, 由slave节点完成读的操作</p>
<p>在solrCloud中, 读写是分离的</p>
</blockquote>
<ul>
<li>副本分裂</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1558144177890.png" alt="1558144177890"></p>
<blockquote>
<p>如果想要删除一个分片, 必须要将这个分片进行分裂, 因为如果不分裂, 那么这个分片中是有整个索引库中一部分的数据的, 不允许删除</p>
</blockquote>
<h3 id="3-solrCloud相关的管理命令"><a href="#3-solrCloud相关的管理命令" class="headerlink" title="3. solrCloud相关的管理命令"></a>3. solrCloud相关的管理命令</h3><h4 id="3-1-创建新集群-创建一个索引库"><a href="#3-1-创建新集群-创建一个索引库" class="headerlink" title="3.1 创建新集群(创建一个索引库)"></a>3.1 创建新集群(创建一个索引库)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.72.141:8080/solr/admin/collections?action=CREATE&amp;name=collection2&amp;numShards=2&amp;replicationFactor=3&amp;maxShardsPerNode=8&amp;property.schema=schema.xml&amp;property.config=solrconfig.xml</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">接口参数说明:</span><br><span class="line"></span><br><span class="line">action: 表示执行的操作 CREATE 创建</span><br><span class="line">name: 新集群的名称</span><br><span class="line">numShards: 分片数</span><br><span class="line">replicationFactor: 每个分片的节点数</span><br><span class="line">maxShardsPerNode: 设置每个分片的最大节点数, 默认为1</span><br><span class="line">property.schema: 指定使用的schema文件   (注意, 此文件必须在zookeeper上存在)</span><br><span class="line">property.config: 指定使用的solrConfig文件 (注意, 此文件必须在zookeeper上存在)</span><br></pre></td></tr></table></figure>

<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1533636808020.png" alt="1533636808020"></p>
<h4 id="3-2-删除core命令"><a href="#3-2-删除core命令" class="headerlink" title="3.2 删除core命令"></a>3.2 删除core命令</h4><blockquote>
<p>会将真实的索引库的数据删除, 这个命令慎用</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.72.141:8080/solr/admin/collections?action=DELETE&amp;name=collection1</span><br></pre></td></tr></table></figure>

<h4 id="3-3-查询所有的Core"><a href="#3-3-查询所有的Core" class="headerlink" title="3.3 查询所有的Core"></a>3.3 查询所有的Core</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.72.141:8080/solr/admin/collections?action=LIST</span><br></pre></td></tr></table></figure>

<h4 id="3-4-显示core的状态"><a href="#3-4-显示core的状态" class="headerlink" title="3.4 显示core的状态"></a>3.4 显示core的状态</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.72.141:8080/solr/admin/collections?action=clusterstatus</span><br></pre></td></tr></table></figure>

<h4 id="3-5-分裂shard-扩展容量"><a href="#3-5-分裂shard-扩展容量" class="headerlink" title="3.5 分裂shard(扩展容量)"></a>3.5 分裂shard(扩展容量)</h4><p>分裂: 就是将某个分片分成两个分片</p>
<p>​    注意: 一旦分裂后, 虽然原来的分片还可以提供服务, 但是已经不再保存数据, 会将数据保存到新的分裂后的分片</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.72.141:8080/solr/admin/collections?action=SPLITSHARD&amp;collection=collection2&amp;shard=shard1</span><br><span class="line"></span><br><span class="line">参数说明:</span><br><span class="line">shard: 指定要分裂的分片</span><br></pre></td></tr></table></figure>

<h4 id="3-6-删除某个分片"><a href="#3-6-删除某个分片" class="headerlink" title="3.6 删除某个分片"></a>3.6 删除某个分片</h4><blockquote>
<p>只是一个逻辑删除, 不会真正的将分片直接删除的, </p>
<p>如果要将分片数据全部删除, 需要手动一个个删除</p>
</blockquote>
<p>注意: 删除的分片必须是已经被分裂的, 或者是已经无法提供服务的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.72.141:8080/solr/admin/collections?action=DELETESHARD&amp;shard=shard2&amp;collection=collection2</span><br></pre></td></tr></table></figure>

<h3 id="4-使用solrj连接集群-完成基本的索引库操作"><a href="#4-使用solrj连接集群-完成基本的索引库操作" class="headerlink" title="4. 使用solrj连接集群, 完成基本的索引库操作"></a>4. 使用solrj连接集群, 完成基本的索引库操作</h3><h4 id="4-1-导入相关的pom依赖"><a href="#4-1-导入相关的pom依赖" class="headerlink" title="4.1 导入相关的pom依赖"></a>4.1 导入相关的pom依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.solr<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>solr-solrj<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-logging-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="4-2-编写代码-完成CURD"><a href="#4-2-编写代码-完成CURD" class="headerlink" title="4.2 编写代码,完成CURD"></a>4.2 编写代码,完成CURD</h4><ul>
<li>添加(修改)索引</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. 添加索引数据 :</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">indexWriterTest</span><span class="params">()</span> <span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line">       <span class="comment">//1.创建一个solrj连接solrCloud的服务对象</span></span><br><span class="line">       <span class="comment">// 如果想要使用 node01 : 2181 这种方式, 必须保证, node01 是在本地Windows环境下的hosts文件中配置上</span></span><br><span class="line">       <span class="comment">// 验证是否配置:  打开cmd  执行: ping node01</span></span><br><span class="line">       String zkHost = <span class="string">"node01:2181,node02:2181,node03:2181"</span>;</span><br><span class="line">       CloudSolrServer solrServer = <span class="keyword">new</span> CloudSolrServer(zkHost);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//2. 设置相关的参数:    一个必须, 两个可选</span></span><br><span class="line">       solrServer.setDefaultCollection(<span class="string">"collection2"</span>); <span class="comment">// 默认连接那个索引库</span></span><br><span class="line">       <span class="comment">// zookeeper会帮助我们分配一个(不是很繁忙的节点)solrCloud的节点供我们使用,</span></span><br><span class="line">       solrServer.setZkConnectTimeout(<span class="number">5000</span>); <span class="comment">//  从zookeeper中获取连接的超时时间</span></span><br><span class="line">       solrServer.setZkClientTimeout(<span class="number">5000</span>);  <span class="comment">// 连接zookeeper的超时时间</span></span><br><span class="line">       <span class="comment">//3. 从zookeeper中获取连接</span></span><br><span class="line">       solrServer.connect();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//4. 执行添加数据的操作:</span></span><br><span class="line">       SolrInputDocument doc = <span class="keyword">new</span> SolrInputDocument();</span><br><span class="line">       doc.addField(<span class="string">"id"</span>,<span class="number">1</span>);</span><br><span class="line">       doc.addField(<span class="string">"title"</span>,<span class="string">"世界上最傻的焊接工"</span>);</span><br><span class="line">       doc.addField(<span class="string">"content"</span>,<span class="string">"其实还有比你更傻的, 把自己缝在被罩了"</span>);</span><br><span class="line">       solrServer.add(doc);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//5. 提交数据</span></span><br><span class="line">       solrServer.commit();</span><br><span class="line"></span><br><span class="line">       </span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>删除索引</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除索引</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span>  <span class="title">delIndexTest</span><span class="params">()</span> <span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line">        <span class="comment">//1. 创建一个solrj连接solrCloud的服务对象</span></span><br><span class="line">        String zkHost = <span class="string">"192.168.72.141:2181,192.168.72.142:2181,192.168.72.143:2181"</span>;</span><br><span class="line">        CloudSolrServer solrServer = <span class="keyword">new</span> CloudSolrServer(zkHost);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.1 设置相关的参数: 1个必须 两个可选</span></span><br><span class="line">        solrServer.setDefaultCollection(<span class="string">"collection2"</span>);</span><br><span class="line"></span><br><span class="line">        solrServer.setZkClientTimeout(<span class="number">5000</span>);</span><br><span class="line">        solrServer.setZkConnectTimeout(<span class="number">5000</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.2 获取连接</span></span><br><span class="line">        solrServer.connect();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 添加删除的条件</span></span><br><span class="line">        solrServer.deleteById(<span class="string">"1"</span>);</span><br><span class="line">       <span class="comment">// solrServer.deleteByQuery("id:1");</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. 提交执行</span></span><br><span class="line">        solrServer.commit();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询索引</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询索引</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">indexSearcherTest</span><span class="params">()</span> <span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line">        <span class="comment">//1. 创建一个solrj连接solrCloud的服务对象</span></span><br><span class="line">        String zkHost = <span class="string">"node01:2181,node02:2181,node03:2181"</span>;</span><br><span class="line">        CloudSolrServer solrServer = <span class="keyword">new</span> CloudSolrServer(zkHost);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.1 设置相关的参数: 1个必须 两个可选</span></span><br><span class="line">        solrServer.setDefaultCollection(<span class="string">"collection2"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.2 获取连接</span></span><br><span class="line">        solrServer.connect();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 封装查询的条件</span></span><br><span class="line">        SolrQuery solrQuery = <span class="keyword">new</span> SolrQuery(<span class="string">"*:*"</span>);</span><br><span class="line">        <span class="comment">//3. 执行查询</span></span><br><span class="line">        QueryResponse response = solrServer.query(solrQuery);</span><br><span class="line">        <span class="comment">//4. 获取数据</span></span><br><span class="line">        SolrDocumentList documentList = response.getResults();</span><br><span class="line">        <span class="keyword">for</span> (SolrDocument document : documentList) &#123;</span><br><span class="line"></span><br><span class="line">            String id = (String) document.get(<span class="string">"id"</span>);</span><br><span class="line">            String title = (String) document.get(<span class="string">"title"</span>);</span><br><span class="line">            String content = (String) document.get(<span class="string">"content"</span>);</span><br><span class="line"></span><br><span class="line">            System.out.println(id+<span class="string">"   "</span>+ title +<span class="string">"   "</span>+ content);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-搜索门户与solr服务的架构"><a href="#5-搜索门户与solr服务的架构" class="headerlink" title="5. 搜索门户与solr服务的架构"></a>5. 搜索门户与solr服务的架构</h3><p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1541863320833.png" alt="1541863320833"></p>
<p>如何实现系统通信:</p>
<p>​       1、Web-service：效率不高基于soap协议。项目中不推荐使用。 (http + xml)</p>
<p>​       2、使用restful形式的服务：http+json。很多项目中应用。如果服务太多，服务之间调用关系混乱，需要治疗服务。</p>
<p>​       3、使用dubbo。使用rpc协议进行远程调用，直接使用socket通信。传输效率高，并且可以统计出系统之间的调用关系、调用次数。<strong>分布式项目中经常采用此种方式</strong></p>
<h2 id="5-dubbox框架"><a href="#5-dubbox框架" class="headerlink" title="5.dubbox框架"></a>5.dubbox框架</h2><p>​    Dubbox 是一个分布式服务框架，其前身是阿里巴巴开源项目Dubbo ，被国内电商及互联网项目中使用，后期阿里巴巴停止了该项目的维护，当当网便在Dubbo基础上进行优化，并继续维护，为了与原有的Dubbo区分，故将其命名为<strong>Dubbox</strong>。 2016年阿里重新将dubbo进行了维护, 并在2017将dubbo贡献给apache, 目前已经成为apache的顶级的项目</p>
<p>​    Dubbox 致力于提供高性能和透明化的RPC远程服务调用方案</p>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1541863595545.png" alt="1541863595545"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">节点角色说明：</span><br><span class="line">	Provider: 暴露服务的服务提供方。</span><br><span class="line">	Consumer: 调用远程服务的服务消费方。</span><br><span class="line">	Registry: 服务注册与发现的注册中心。</span><br><span class="line">	Monitor: 统计服务的调用次调和调用时间的监控中心。</span><br><span class="line">	Container: 服务运行容器。</span><br><span class="line">调用关系说明：</span><br><span class="line">	0. 服务容器负责启动，加载，运行服务提供者。</span><br><span class="line">	1. 服务提供者在启动时，向注册中心注册自己提供的服务。</span><br><span class="line">	2. 服务消费者在启动时，向注册中心订阅自己所需的服务。</span><br><span class="line">	3. 注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者。</span><br><span class="line">	4. 服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，再选另一台调用。</span><br><span class="line">	5. 服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中心。</span><br></pre></td></tr></table></figure>

<h3 id="5-1-dubbox的基本使用"><a href="#5-1-dubbox的基本使用" class="headerlink" title="5.1 dubbox的基本使用"></a>5.1 dubbox的基本使用</h3><p>​    dubbox官方推荐使用zookeeper作为dubbox的注册中心, 负责服务地址的注册与查找,服务提供者和消费者只在启动时与注册中心交互，注册中心不转发请求，压力较小。</p>
<blockquote>
<p>需注意, dubbox并没有在maven的中央仓库中存在, 需要手动将Dubbox的jar包安装到我的本地仓库中。</p>
<p>先将dubbo-2.8.4.jar包放到e:\setup, 然后输入命令</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1) 查看maven的环境变量是否存在:  打开cmd  执行 mvn -version</span><br><span class="line">2) 执行下列的命令即可</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn install:install-file -Dfile=e:\setup\dubbo-2.8.4.jar -DgroupId=com.alibaba -DartifactId=dubbo -Dversion=2.8.4 -Dpackaging=jar</span><br></pre></td></tr></table></figure>

<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1546412674865.png" alt="1546412674865"></p>
<ul>
<li>1) 创建一个父工程: gossip-dubboxDemo-parent<ul>
<li>在父工程中添加如下依赖</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 集中定义依赖版本号 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">junit.version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">junit.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>4.2.4.RELEASE<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-api.version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">servlet-api.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dubbo.version</span>&gt;</span>2.8.4<span class="tag">&lt;/<span class="name">dubbo.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">zookeeper.version</span>&gt;</span>3.4.7<span class="tag">&lt;/<span class="name">zookeeper.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">zkclient.version</span>&gt;</span>0.1<span class="tag">&lt;/<span class="name">zkclient.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mybatis.version</span>&gt;</span>3.2.8<span class="tag">&lt;/<span class="name">mybatis.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mybatis.spring.version</span>&gt;</span>1.2.2<span class="tag">&lt;/<span class="name">mybatis.spring.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>5.1.32<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">druid.version</span>&gt;</span>1.0.9<span class="tag">&lt;/<span class="name">druid.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">freemarker.version</span>&gt;</span>2.3.23<span class="tag">&lt;/<span class="name">freemarker.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">solrj.version</span>&gt;</span>4.10.2<span class="tag">&lt;/<span class="name">solrj.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javassist.version</span>&gt;</span>3.11.0.GA<span class="tag">&lt;/<span class="name">javassist.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- spring 相关的依赖包 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-beans<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jms<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context-support<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- mybatis 相关的依赖包 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mybatis.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mybatis.spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- springmvc的相关依赖包 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- 数据库的相关依赖包 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mysql.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 连接池 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;druid.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- 日志相关的依赖包 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!--json相关的依赖--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!--solr相关依赖--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.solr<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>solr-solrj<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;solrj.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!--测试相关--&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;junit.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!--dubbox相关依赖--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;dubbo.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--zookeeper相关依赖--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.zookeeper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zookeeper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;zookeeper.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.sgroschupf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zkclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;zkclient.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javassist<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javassist<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;javassist.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>2) 创建服务提供者: dubboxdemo-service  (war工程)</p>
<ul>
<li>2.1) 添加如下内容依赖:</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- Spring --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-beans<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jms<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context-support<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>	</span><br><span class="line">		<span class="comment">&lt;!-- dubbo相关 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>			</span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.zookeeper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zookeeper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.sgroschupf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zkclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>		</span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javassist<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javassist<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>		</span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">build</span>&gt;</span>  </span><br><span class="line">	  <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">	      <span class="tag">&lt;<span class="name">plugin</span>&gt;</span>  </span><br><span class="line">	          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">	          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">	          <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line">	          <span class="tag">&lt;<span class="name">configuration</span>&gt;</span>  </span><br><span class="line">	              <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">source</span>&gt;</span>  </span><br><span class="line">	              <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target</span>&gt;</span>  </span><br><span class="line">	          <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span>  </span><br><span class="line">	      <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span>  </span><br><span class="line">	      <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat7-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">					<span class="comment">&lt;!-- 指定端口 --&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">port</span>&gt;</span>8081<span class="tag">&lt;/<span class="name">port</span>&gt;</span></span><br><span class="line">					<span class="comment">&lt;!-- 请求路径 --&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">path</span>&gt;</span>/<span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">	  	  <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>2.2) 在工程的webapps下创建WEB-INF文件夹，找到web.xml,添加如下内容</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 加载spring容器 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext*.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">listener</span>&gt;</span>		</span><br><span class="line">        <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>2.3) 创建一个业务的接口<ul>
<li>创建包:com.cyannote.dubboxdemo.service,用于存放业务接口</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.dubboxdemo.service;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 业务接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span></span>;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>2.4) 创建业务实现类<ul>
<li>创建包com.cyannote.dubboxdemo.service.impl ，用于存放业务实现类。创建业务实现类：</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.dubboxdemo.service.impl;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.annotation.Service;</span><br><span class="line"><span class="keyword">import</span> cn.itcast.dubbodemo.service.UserService;</span><br><span class="line"><span class="comment">//注意：Service注解与原来不同，需要引入com.alibaba包下的</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;		</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"itcast"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>2.5) 编写配置文件<ul>
<li>在resources下创建applicationContext-service.xml ,内容如下：</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:p</span>=<span class="string">"http://www.springframework.org/schema/p"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:dubbo</span>=<span class="string">"http://code.alibabatech.com/schema/dubbo"</span> <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">"dubboxdemo-service"</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">protocol</span>=<span class="string">"zookeeper"</span> <span class="attr">address</span>=<span class="string">"192.168.72.141:2181,192.168.72.142:2181,192.168.72.143:2181"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注意：dubbo:annotation用于扫描@Service注解。--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:annotation</span> <span class="attr">package</span>=<span class="string">"com.cyannote.dubboxdemo.service"</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>2.6) 测试运行</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tomcat7:run</span><br></pre></td></tr></table></figure>
</li>
<li><p>3.服务消费者开发</p>
<ul>
<li>3.1) 创建Maven工程（WAR）dubboxdemo-web ，在pom.xml引入依赖 ，同“dubboxdemo-service”工程。区别就是把tomcat插件的运行端口改为8082 。</li>
<li>3.2) 在webapps下WEB-INF 目录，找到web.xml,添加如下内容</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 解决post乱码 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span>		</span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">init-param</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span>  </span><br><span class="line">	<span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span>		</span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span>  	</span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 指定加载的配置文件 ，通过参数contextConfigLocation加载--&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext-web.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>3.3) 拷贝业务接口<ul>
<li>将“dubboxdemo-service”工程的cn.itcast.dubboxdemo.service 包以及下面的接口拷贝至此工程。</li>
</ul>
</li>
<li>3.4) 编写Controller : 包名:  cn.itcast.dubboxdemo.controller</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.dubboxdemo.controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> cn.itcast.dubbodemo.service.UserService;</span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Reference</span></span><br><span class="line">	<span class="keyword">private</span> UserService userService;	</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/showName"</span>)</span><br><span class="line">	<span class="meta">@ResponseBody</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">showName</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userService.getName();</span><br><span class="line">	&#125;		</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>3.5) 编写spring配置文件<ul>
<li>在src/main/resources下创建applicationContext-web.xml</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:p</span>=<span class="string">"http://www.springframework.org/schema/p"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:dubbo</span>=<span class="string">"http://code.alibabatech.com/schema/dubbo"</span> <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">mvc:annotation-driven</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mvc:message-converters</span> <span class="attr">register-defaults</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.StringHttpMessageConverter"</span>&gt;</span>  </span><br><span class="line">				<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">bean</span>&gt;</span>  </span><br><span class="line">		<span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span>	</span><br><span class="line">	<span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 引用dubbo 服务 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">"dubboxdemo-web"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">protocol</span>=<span class="string">"zookeeper"</span> <span class="attr">address</span>=<span class="string">"192.168.72.141:2181,192.168.72.142:2181,192.168.72.143:2181"</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dubbo:annotation</span> <span class="attr">package</span>=<span class="string">"com.cyannote.dubboxdemo.controller"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>3.6) 测试运行</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tomcat7:run</span><br><span class="line"></span><br><span class="line">在浏览器输入http://localhost:8082/user/showName.do，查看浏览器输出结果</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p><img src="F:/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/%E5%A8%B1%E4%B9%90%E5%A4%B4%E6%9D%A1/day08_search_solrCloud/%E7%AC%94%E8%AE%B0/assets/1558167764563.png" alt="1558167764563"></p>
<p>使用步骤:</p>
<p>1) 导包:  spring +dubbox+zookeeper</p>
<p>2) 添加spring的配置文件:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dubbo:application name=&quot;dubboxdemo-web&quot; /&gt;</span><br><span class="line">&lt;dubbo:registry protocol=&quot;zookeeper&quot; address=&quot;192.168.72.141:2181,192.168.72.142:2181,192.168.72.143:2181&quot;/&gt;</span><br><span class="line">&lt;!--只需要更改扫描包的位置--&gt;</span><br><span class="line">&lt;dubbo:annotation package=&quot;com.cyannote.dubboxdemo.controller&quot; /&gt;</span><br></pre></td></tr></table></figure>

<p>3) 在服务端添加 @service注解, 在web端添加@Reference</p>
<p>总结: </p>
<ul>
<li>solrCloud :   <ul>
<li>1) 为什么要使用solrCloud: 搜索高并发 , 索引量大</li>
<li>2) 如果部署solrCloud需要先部署一个zookeeper<ul>
<li>zookeeper: 是一个集群的管理工具, 在solrCloud中主要用来管理配置文件, 集群状态, solrCloud主节点选举</li>
</ul>
</li>
<li>3) 能够将zookeeper集群 和 solrCloud的集群搭建成功</li>
<li>4) 使用solrCloud的管理命令创建一个新的索引库(符合结构规定)</li>
<li>5) 使用solrj完成对solrCloud的操作</li>
</ul>
</li>
<li>dubbox:<ul>
<li>基本使用</li>
<li>理解: 为什么要使用dubbox</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://cyannote.github.io.git/Search/" data-id="cjycoezq00004l47ktx50649o" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/Redis/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Redis
        
      </div>
    </a>
  
  
    <a href="/XML学习笔记/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">xml笔记</div>
    </a>
  
</nav>

  
</article>



</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <h1 class="blog-title">Hexo</h1>
    <h2 class="blog-subtitle"></h2>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>标签</li>
          </a>
        
    </ul>
  </div>
</div>

  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="/source/plugin/img/avatar.jpg">
    <h2 class="author">inverse</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>17</strong><br>文章</div></a>
      <a href="/categories"><div><strong>0</strong><br>分类</div></a>
      <a href="/tags"><div><strong>0</strong><br>标签</div></a>
    </div>



    <div class="social-link">
      
        <a class="hvr-bounce-in" href="http://github.com/cyannote" target="_blank" title="Github">
          Github
        </a>
      
    </div>

    <div class="friend-link">
      <h2>友情链接</h2>
      
        <a class="hvr-bounce-in" href="http://blog.shanamaid.top/" target="_blank" title="ShanaMaid">
          ShanaMaid
        </a>
      
    </div>
  </div>
</div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy;2018 - 2019 inverse<br>
      由<a href="http://hexo.io/" target="_blank">Hexo</a>强力驱动 | 
      主题-<a href="https://github.com/ShanaMaid/hexo-theme-shana">Shana</a>
      
    </div>
    
  </div>
</footer>
    </div>
    

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="//apps.bdimg.com/libs/wow/0.1.6/wow.min.js"></script>
<script>
new WOW().init();
</script>   


  <link rel="stylesheet" href="/plugin/fancybox/jquery.fancybox.css">
  <script src="/plugin/fancybox/jquery.fancybox.pack.js"></script>



  <link rel="stylesheet" href="/plugin/galmenu/GalMenu.css">
  <script src="/plugin/galmenu/GalMenu.js"></script>
  <div class="GalMenu GalDropDown">
      <div class="circle" id="gal">
        <div class="ring">
          
            <a href="/" title class="menuItem">首页</a>
          
            <a href="/tags" title class="menuItem">标签</a>
          
            <a href="/categories" title class="menuItem">分类</a>
          
            <a href="/archives" title class="menuItem">归档</a>
          
            <a href="/xxxxxxxxx" title class="menuItem">xxx</a>
          
            <a href="/xxxxxxx" title class="menuItem">xxxx</a>
          
        </div>
        
          <audio id="audio" src="#"></audio>
        
      </div> 
</div>
<div id="overlay" style="opacity: 1; cursor: pointer;"></div>
  <script type="text/javascript">var items = document.querySelectorAll('.menuItem');
    for (var i = 0,
    l = items.length; i < l; i++) {
      items[i].style.left = (50 - 35 * Math.cos( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%";
      items[i].style.top = (50 + 35 * Math.sin( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%"
    }</script>
<script type="text/javascript">
  $(document).ready(function() {
    $('body').GalMenu({
      'menu': 'GalDropDown'
    })
  });
</script>

  <section class="hidden-xs"> 
  <ul class="cb-slideshow"> 
    <li><span>苟利</span></li> 
    <li><span>国家</span></li> 
    <li><span>生死以</span></li> 
    <li><span>岂能</span></li> 
    <li><span>祸福</span></li> 
    <li><span>趋避之</span></li> 
  </ul>
</section>
<script src="/js/script.js"></script>



  </div>
</body>
</html>